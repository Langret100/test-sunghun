<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>마이파이</title>
  <link rel="icon" type="image/png" href="images/etcimage/mypai-icon-square.png">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <link rel="stylesheet" href="css/ghost.css">

<style>
/* 게임 오버레이 공통 스타일 */
.game-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: flex;
  flex-direction: column;
  z-index: 9998;
}
.game-overlay.hidden { display: none; }
.game-topbar {
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  background: rgba(0,0,0,0.8);
}
.game-close-btn {
  margin-right: 10px;
  min-width: 32px;
  height: 32px;
  border-radius: 999px;
  border: none;
  background: rgba(255,255,255,0.1);
  color: #fff;
  font-size: 18px;
  cursor: pointer;
  transition: transform 0.1s ease, background 0.1s ease;
}
.game-close-btn:active {
  transform: scale(0.9);
  background: rgba(255,255,255,0.3);
}
.game-frame {
  flex: 1;
  width: 100%;
  border: none;
}

/* 게임 모드일 때 고스트를 화면 하단 구석에 배치 */
body.is-game-mode #ghostContainer {
  position: fixed;
  right: 3vw;
  bottom: 0;
  transform: scale(0.55);
  transform-origin: bottom right;
  z-index: 9999;
}
body.is-game-mode #ghost {
  pointer-events: none;
}

/* 수첩 메뉴 메모 라벨 폰트 조금 키우기 */
.notebook-overlay .memo-label {
  font-size: 15px;
}
</style></head>
<body>
<!-- [옵션 기능] 게임 전체화면 오버레이 -->
<div id="gameOverlay" class="game-overlay hidden">
  <div class="game-topbar">
    <button id="gameCloseBtn" class="game-close-btn">✕</button>
  </div>
  <iframe id="gameFrame" class="game-frame" src=""></iframe>
</div>

  <div id="canvasWrapper">
    <div id="clockWidget" class="clock-widget"></div>
    <div id="bg-container">
      <div id="bg-back-wrap">
        <img class="bg-back" src="images/wallpaper/wallpaper1.png" alt="">
        <img class="bg-back bg-back-mirror" src="images/wallpaper/wallpaper1.png" alt="">
      </div>
      <img id="bg-front" src="images/wallpaper/wall1.png" alt="">
    </div>

    <div id="waveBackground">
      <svg class="wave-svg wave1" viewBox="0 0 1200 200" preserveAspectRatio="none">
        <path d="M0,120 C150,80 300,160 450,120 C600,80 750,160 900,120 C1050,80 1200,160 1350,120" />
      </svg>
      <svg class="wave-svg wave2" viewBox="0 0 1200 200" preserveAspectRatio="none">
        <path d="M0,100 C160,140 320,60 480,110 C640,160 800,60 960,110 C1120,160 1280,60 1440,110" />
      </svg>
    </div>

    <div id="ghostContainer">
      <div id="ghost"></div>
    </div>

    <div id="bubbleWrapper" class="hidden">
      <div class="bubble"><span id="bubbleText"></span></div>
    </div>

    <div id="chatDock">
      <div id="chatPanel">
        <button id="socialToggleBtn" class="social-toggle-btn" title="소통 모드 전환"></button>
        <div id="log"></div>
        <div id="inputRow">
          <input id="userInput" type="text" placeholder="웹 고스트에게 뭐든 물어보거나 말을 걸어보세요. (예: 가위바위보, ~가 궁금해)">
          <div class="emoji-wrapper">
            <button id="emojiBtn" class="emoji-btn" title="이모티콘">😊</button>
            <div id="emojiPanel" class="emoji-panel"></div>
          </div>
          <button id="sendBtn">보내기</button>
          <div class="ghost-plus-wrapper">
            <button id="ghostPlus" class="ghost-plus-btn">+</button>
                        <div id="plusMenu">
              <button data-action="social-messenger">📱 실시간 톡 보기</button>
              <button id="plusSocialBtn" data-action="social">💬 마이파-톡</button>
              <button data-action="teach">🧠 가르치기</button>
              <button data-action="char">🎭 캐릭터 변경</button>
              <button data-action="help">📖 사용 설명서</button>
              <button data-action="bgselect">🎨 배경 선택</button>
              <button data-action="menu">📔 메뉴</button>
                            <button data-action="login">🔑 로그인</button>
<button data-action="settings">🔊 읽어주기</button>
            </div>
          </div>
        </div>

<!-- 사용 설명서 패널 (manual-panel.js 모듈 전용) -->
<div id="manualPanel" class="manual-panel hidden">
  <div class="manual-backdrop"></div>
  <div class="manual-inner">
    <div class="manual-header">
      <div class="manual-title">📖 사용 설명서</div>
      <button id="manualCloseBtn" class="manual-close">✕</button>
    </div>
    <div class="manual-body">
      <div class="manual-list">
        <button class="manual-item" data-manual-key="chat">💬 기본 대화</button>
        <button class="manual-item" data-manual-key="teach">🧠 가르치기</button>
        <button class="manual-item" data-manual-key="char">🎭 캐릭터 변경</button>
        <button class="manual-item" data-manual-key="games">🎮 미니 게임</button>
        <button class="manual-item" data-manual-key="note">📔 수첩 / 게시판</button>
        <button class="manual-item" data-manual-key="etc">✨ 기타 기능</button>
      </div>
      <div id="manualDetail" class="manual-detail">
        기능을 선택하면 자세한 설명이 여기에 나타납니다.
      </div>
    </div>
  </div>
</div>

<!-- 게시판 패널 -->
<div id="boardPanel" class="board-panel hidden">
  <div class="board-backdrop"></div>
  <div class="board-inner">
    <div class="board-header">
      <div class="board-title">📋 게시판</div>
      <button id="boardCloseBtn" class="board-close">✕</button>
    </div>
    <div class="board-body">
      <div class="board-list-section">
        <div class="board-list-header">
          <span>최근 글</span>
          <div class="board-list-actions">
            <button id="boardReloadBtn" class="board-reload-btn">새로고침</button>
            <button id="boardWriteToggleBtn" class="board-write-btn">글쓰기</button>
          </div>
        </div>
        <div id="boardListContainer" class="board-list"></div>
        <div class="board-pagination">
          <button id="boardPrevPageBtn" class="board-page-btn">이전 페이지</button>
          <span id="boardPageInfo" class="board-page-info">1 / 1</span>
          <button id="boardNextPageBtn" class="board-page-btn">다음 페이지</button>
        </div>
        <div id="boardHint" class="board-hint hidden">아래에 제목을 누르면 내용을 확인할 수 있습니다.</div>
      </div>
      <div id="boardEditorSection" class="board-editor-section">
        <!-- 중앙 모달 글쓰기 기능 사용으로 이 영역은 비워둡니다. -->
      </div>
    </div>
  </div>
</div>

<div id="teachModal" class="teach-modal hidden">
  <div class="teach-title">🧠 고스트에게 가르치기</div>
  <label class="teach-label">사용자가 말할 문장/단어</label>
  <input id="teachTrigger" type="text" class="teach-input" placeholder="예: 나 기운 없어">
  <label class="teach-label">고스트가 대답할 말</label>
  <textarea id="teachMessage" rows="2" class="teach-textarea" placeholder="예: 많이 힘들었겠다. 잠깐 쉬어가자."></textarea>
  <label class="teach-label">감정 선택</label>
  <select id="teachEmotion" class="teach-select">
    <option value="">자동 선택</option>
    <option value="위로">위로</option>
    <option value="슬픔">슬픔</option>
    <option value="분노">분노</option>
    <option value="신남">신남</option>
    <option value="기쁨">기쁨</option>
    <option value="실망">실망</option>
    <option value="절망">절망</option>
    <option value="지침">지침</option>
    <option value="경청">경청</option>
    <option value="기본대기">무표정/기본</option>
  </select>
  <div class="teach-buttons">
    <button id="teachSaveBtn" type="button">저장하기</button>
    <button id="teachCloseBtn" type="button">닫기</button>
  </div>
  <div id="teachStatus" class="teach-status"></div>
</div>

<div id="statusBar" >
          <div>상태: <span id="statusEmotion">-</span></div>
          <div id="statusHint">너무 혼자 두면 졸게 되어요…</div>
        </div>
      </div>
    </div>
  </div>

  



  
  <img id="mapMini" src="images/etcimage/map.png" alt="map icon">
  <div id="mapModal">
    <img id="mapLarge" src="images/etcimage/map.png" alt="map large">
  </div>


    <div id="bgSelectPanel">
    <div class="bg-panel-inner">
      <div class="bg-panel-title">배경 선택</div>
      <button class="bg-option" data-bg="default">1) 기본 배경 (그라데이션 + 물결)</button>
      <button class="bg-option" data-bg="snow">2) 눈 내리는 겨울 배경</button>
      <button class="bg-option" data-bg="train">3) 열차 배경 + 지도</button>
      <button class="bg-option" data-bg="custom">4) 사용자 배경 (이미지 업로드)</button>
      <input id="customBgInput" type="file" accept="image/*" style="display:none;">
      <div class="bg-panel-actions">
        <button type="button" id="bgPanelConfirm">확인</button>
      </div>
    </div>
  </div>

  <script src="js/emotion.js"></script>
  <script src="js/global-interaction-guard.js"></script>
  <script src="js/ui.js"></script>
  <!-- [옵션 기능] 말풍선 음성 읽어주기(TTS) 모듈 -->
  <script src="js/tts-voice.js"></script>
  <!-- [옵션 기능] 보내기 버튼 길게 눌러 음성 인식 입력 모듈 -->
  <script src="js/speech-input.js"></script>
  <!-- [옵션 기능] 오늘의 퀘스트(퀘스트 탐사) 모듈 -->
  <script src="js/quest-explorer.js"></script>
  <!-- [옵션 기능] 나의 코인 상태 표시 모듈 (coin-status.js)
       이 기능이 필요 없으면 아래 <script>와 js/coin-status.js 파일을 함께 삭제하면 됩니다. -->
  <script src="js/coin-status.js"></script>
  <script src="js/coin-reward.js"></script>
  <!-- [옵션 기능] 코인 보너스(출석/랭킹/퀘스트 자동 보상) 모듈 -->
  <script src="js/coin-bonus.js"></script>
  <!-- [옵션 기능] 수첩(메뉴) UI 모듈 -->
  <!-- js/notebook-menu.js 파일을 삭제했다면,
       아래 <script> 태그도 함께 삭제해도 됩니다. -->
  <script src="js/notebook-menu.js"></script>
  <!-- [옵션 기능] 메뉴 게임 런처 모듈 -->
  <script src="js/menu-games.js"></script>
  <!-- [옵션 기능] 게임 모드 관리자 모듈 -->
  <script src="js/game-manager.js"></script>
  <!-- [옵션 기능] 모바일 UI 보정 모듈 -->
  <script src="js/mobile-ui.js"></script>
  <script src="js/actions.js"></script>
    <script src="js/login.js"></script>
  <script src="js/letters-local.js"></script>
  <script src="js/background.js"></script>
  <script src="js/bg-effects.js"></script>
  <!-- [옵션 기능] 가르치기(학습) 내용 구글 시트 저장 모듈 -->
  <!-- js/teach-save.js 파일을 삭제했다면,
       아래 <script> 태그도 함께 삭제해도 됩니다. (가르치기 내용 시트 저장 기능) -->
  <script src="js/teach-save.js"></script>

<!-- 수첩형 메뉴 오버레이 -->
<div id="notebook-menu-overlay" class="notebook-overlay hidden">
  <div class="notebook-backdrop"></div>
  <div class="notebook-wrapper">
    <div class="notebook-tabs">
      <span class="tab">MENU</span>
      <span class="tab bookmark">★</span>
    </div>
    <div class="notebook-body">
      <div class="notebook-left">
        <div class="notebook-title">고스트 수첩</div>
        <div class="notebook-subtitle">원하는 메모지를 눌러 보세요.</div>
      </div>
      <div class="notebook-right">
        <div class="memo-grid">
          <!-- 상단 3칸: 출석 확인, 게시판, 편지 -->
          <button class="memo-card" data-page="attendance">
            <div class="memo-label">출석 확인</div>
          </button>
          <button class="memo-card" data-page="board">
            <div class="memo-label">게시판</div>
          </button>
          <button class="memo-card" data-page="letter">
            <div class="memo-label">편지</div>
          </button>
          <!-- 하단 3칸: 메뉴 게임들 (구구단, 덧셈주사위, 꿈틀도형) -->
          <button class="memo-card" data-page="game1">
            <div class="memo-label">구구단<br>게임</div>
          </button>
          <button class="memo-card" data-page="game2">
            <div class="memo-label">덧셈<br>주사위</div>
          </button>
          <button class="memo-card" data-page="game3">
            <div class="memo-label">꿈틀도형</div>
          </button>
          <button class="memo-card" data-page="quest">
            <div class="memo-label">오늘의<br>퀘스트</div>
          </button>
          <button class="memo-card" data-page="arcamera">
            <div class="memo-label">AR<br>카메라</div>
          </button>
        </div>
      </div>
    </div>
    <button class="notebook-close-btn" id="notebook-close-btn">✕</button>
  </div>
</div>



-save.js"></script>
  <script src="js/teach.js"></script>
  <script src="js/map.js"></script>
  <script src="js/settings.js"></script>
  <script src="js/dialog.js"></script>
  <script src="js/chat-emoji.js"></script>
  <script src="js/startup.js"></script>
  <script src="js/core.js"></script>
  <script src="js/ghost-hide.js"></script>
  <script src="js/messenger-chat-command.js"></script>
  

  


    <!-- --------------------------------------------
         [옵션 기능] 게시판 글쓰기 중앙 모달
         - js/board-write-modal.js 가 있을 때만 작동합니다.
         - 이 기능을 제거하려면:
             1) 이 HTML 블록 전체 삭제
             2) index.html 내 <script src="js/board-write-modal.js"> 제거
         -------------------------------------------- -->
    <div id="boardWriteModal" class="board-write-modal hidden">
      <div class="board-write-modal-bg"></div>

      <div class="board-write-modal-box">
        <div class="board-write-modal-title">✏️ 새 글 쓰기</div>

        <input id="boardTitleInput" class="board-input" type="text" placeholder="제목을 입력해 주세요.">
        <input id="boardAuthorInput" class="board-input" type="text" placeholder="이름(또는 닉네임)">
        <textarea id="boardContentInput" class="board-textarea" rows="4" placeholder="내용을 입력해 주세요."></textarea>

        <button id="boardSaveBtn" class="board-save-btn">등록하기</button>
        <button id="boardWriteCloseBtn" class="board-close-btn">닫기</button>

        <div id="boardStatus" class="board-status"></div>
      </div>
    </div>

  <!-- [옵션 기능] 중앙 글쓰기 모달 컨트롤러 -->
  <!-- 삭제 시 js/board-write-modal.js 및 모달 HTML 블록 제거 -->
  <script src="js/board-write-modal.js"></script>

  </div>
  <!-- [옵션 기능] 알람/타이머 모듈(alarm.js) 연결 시작
       이 기능이 필요 없으면 아래 <script>와 js/alarm.js를 함께 삭제하고,
       dialog.js 안의 알람 연동 블록도 삭제해도 됩니다. -->
  <script src="js/alarm.js"></script>
  <!-- [옵션 기능] 알람/타이머 모듈(alarm.js) 연결 끝 -->
  <!-- [옵션 기능] 출석 도장 모듈(attendance-stamp.js) 연결 시작
       이 기능이 필요 없으면 아래 <script>와 js/attendance-stamp.js를 함께 삭제하고,
       notebook-menu.js / login.js 안의 출석 연동 블록도 삭제해도 됩니다. -->
  <script src="js/clock-display.js"></script>
  <script src="js/game-emotion.js"></script>
  <script src="js/manual-panel.js"></script>
  <script src="js/chat-placeholder.js"></script>
  <script src="js/attendance-stamp.js"></script>
  <!-- [옵션 기능] 출석 도장 모듈(attendance-stamp.js) 연결 끝 -->
  <!-- [옵션 기능] 게임 점수 랭킹 전송 모듈 -->
  <script src="js/game-ranking-report.js"></script>
  <!-- [옵션 기능] 게임 점수 postMessage 브릿지 모듈 -->
  <script src="js/game-score-bridge.js"></script>
  <script src="js/ranking.js"></script>
  <script src="js/ranking_crown.js"></script>
  <!-- [옵션 기능] AR 카메라 모듈 -->
  <!-- 이 모듈을 끄고 싶다면 이 스크립트 태그와 js/ar-camera.js 파일을 삭제하면 됩니다. -->
  <script src="js/ar-camera.js"></script>
  <!-- [옵션 기능] 외부 사이트 열기 모듈 (web-launcher.js)
       이 기능이 필요 없으면 아래 <script>와 js/web-launcher.js를 함께 삭제하고,
       core.js 안의 [옵션 기능] 인터넷 사이트 열기 블록도 삭제해도 됩니다. -->
  <script src="js/web-launcher.js"></script>

  <!-- [옵션 기능] 오늘의 운세 모듈 -->
  <script src="js/fortune-today.js"></script>
  <!-- [옵션 기능] 전체 화면 토글 버튼 모듈 -->
  <script src="js/fullscreen-toggle.js"></script>
  <script src="js/mail-notify.js"></script>
  <script src="js/game-math-explorer-report.js"></script>


  <!-- [옵션 기능] 소통 채팅 (Firebase Realtime Database 연동)
       - js/social-chat-firebase.js 와 함께 동작합니다.
       - Firebase 콘솔에서 발급받은 설정 값으로 social-chat-firebase.js 상단의
         SOCIAL_CHAT_FIREBASE_CONFIG 를 교체해야 합니다.
  -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
  <script src="js/social-chat-firebase.js"></script>

</body>
</html>